/* ==========================================================================
   STATISTIK & HEADER (CLEAN VERSION)
   ========================================================================== */

/* --- 1. HEADER (GEMENSAM FÖR ALLA VYER) --- */

/* Grundstil (Används av Inställningar, Kunder, Statistik) */
.one-ui-header-simple {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
    padding: 16px 20px;
    background: white;
    border-bottom: 1px solid #f1f5f9;
    min-height: 60px;
    box-sizing: border-box;
}

/* Modifierare för Sticky (Endast positionering) */
.one-ui-header-simple.sticky-header-fix {
    position: sticky;
    top: 0;
    z-index: 1000;
    margin: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.header-simple-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-color);
    margin: 0;
    line-height: 1.2;
}

.simple-back-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    color: var(--text-color);
    padding: 8px;
    margin-left: -8px; /* Justering för padding */
    cursor: pointer;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    transition: background 0.2s;
}
.simple-back-btn:active { background: #f1f5f9; }


/* --- 2. KONTROLLER & FILTER --- */

.stats-controls-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
    background: transparent;
}

.date-range-text {
    font-size: 0.85rem;
    font-weight: 600;
    color: #64748b;
}

/* Filter-knapp (Hörn) */
.filter-toggle-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    background: white;
    border: 1px solid #e2e8f0;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
    color: #1e293b;
    box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    cursor: pointer;
    transition: background 0.2s;
}
.filter-toggle-btn:active { background: #f1f5f9; }
.filter-toggle-btn svg { width: 14px; height: 14px; margin-top: 1px; }

/* Filter Meny (Drawer) */
.filter-drawer {
    background: white;
    border-bottom: 1px solid #f1f5f9;
    padding: 12px 20px;
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.filter-drawer-scroll {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    padding-bottom: 4px;
    -ms-overflow-style: none; scrollbar-width: none; /* Dölj scrollbar */
}
.filter-drawer-scroll::-webkit-scrollbar { display: none; }

.filter-pill-large {
    padding: 8px 16px;
    border-radius: 8px;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    color: #64748b;
    font-size: 0.85rem;
    font-weight: 600;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s;
}
.filter-pill-large.active {
    background: #1e293b;
    color: white;
    border-color: #1e293b;
}


/* --- 3. LAYOUT & KPI-KORT --- */

/* Grid för KPI (Tvingad 3-kolumn) */
.fun-stats-grid.compact-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr !important;
    gap: 8px;
    padding: 0 16px;
    width: 100%;
    box-sizing: border-box;
}

.fun-stat-card.compact {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 12px 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.02);
}

.fs-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    font-weight: 600;
    color: #94a3b8;
    margin-bottom: 4px;
}

.fs-val {
    font-size: 1rem;
    font-weight: 800;
    color: #0f172a;
    line-height: 1.1;
}
@media (max-width: 360px) { .fs-val { font-size: 0.85rem; } }

.fs-sub-label {
    font-size: 0.65rem;
    color: #cbd5e1;
    margin-top: 2px;
}

.trend-mini {
    font-size: 0.7rem;
    font-weight: 700;
    margin-top: 4px;
}


/* --- 4. GRAFER & LISTOR --- */

/* Gemensam container-stil */
.chart-card-compact, 
.top-list-card, 
.goal-card.compact {
    background: white;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
    margin: 12px 16px;
}

.chart-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.chart-label, 
.top-list-title {
    font-size: 0.9rem;
    font-weight: 700;
    color: #1e293b;
    margin: 0;
}

.icon-btn-tiny {
    background: transparent;
    border: none;
    color: #94a3b8;
    cursor: pointer;
    padding: 4px;
}

/* Drill Down Lista */
.drill-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #f8fafc;
    cursor: pointer;
}
.drill-item:last-child { border-bottom: none; }

.drill-left { display: flex; flex-direction: column; gap: 2px; }
.drill-reg { font-size: 0.85rem; font-weight: 700; color: #1e293b; }
.drill-desc { font-size: 0.75rem; color: #64748b; }
.drill-price { font-size: 0.85rem; font-weight: 700; }


/* --- 5. NYA FUNKTIONER (Prognos, Mål, Heatmap) --- */

/* Segmented Control (Switch) */
.segmented-control {
    display: flex;
    background: #f1f5f9;
    padding: 3px;
    border-radius: 8px;
}

.seg-btn {
    border: none;
    background: transparent;
    padding: 4px 12px;
    font-size: 0.75rem;
    font-weight: 600;
    color: #64748b;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
}
.seg-btn.active {
    background: white;
    color: #1e293b;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

/* Målsättning (Progress Bar) */
.progress-track {
    width: 100%;
    height: 8px;
    background: #f1f5f9;
    border-radius: 4px;
    overflow: hidden;
}
.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #60a5fa);
    border-radius: 4px;
    transition: width 1s ease-out;
}
.progress-fill.success {
    background: linear-gradient(90deg, #fbbf24, #d97706);
}

/* Insikts-grid (Prognos & Heatmap) */
.insights-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    padding: 0 16px;
    margin-top: 12px;
}

.insight-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 12px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    box-shadow: 0 1px 2px rgba(0,0,0,0.02);
}

.insight-card.purple-theme {
    background: #fdf4ff;
    border-color: #f0abfc;
}

.card-icon-header {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    color: #64748b;
    margin-bottom: 8px;
}
.purple-theme .card-icon-header { color: #a855f7; }
.card-icon-header svg { width: 14px; height: 14px; }

.insight-value {
    font-size: 1.1rem;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 2px;
}
.purple-theme .insight-value { color: #9333ea; }

.insight-sub { font-size: 0.7rem; color: #94a3b8; }
.purple-theme .insight-sub { color: #c084fc; }

/* Heatmap */
.heatmap-container {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    height: 50px;
    padding-top: 4px;
}
.hm-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    height: 100%;
    width: 14%;
}
.hm-bar {
    width: 100%;
    background: #e2e8f0;
    border-radius: 3px;
    transition: height 0.5s ease;
    min-height: 4px;
}
.hm-bar.high { background: #3b82f6; }
.hm-day {
    font-size: 0.6rem;
    color: #94a3b8;
    margin-top: 4px;
    font-weight: 600;
}


/* --- 6. UTIL (Färger, Skeleton, Privacy) --- */

.text-green { color: #10b981; }
.text-blue { color: #3b82f6; }
.highlight-blue { color: #3b82f6; }
.highlight-green { color: #10b981; }
.highlight-dark { color: #1e293b; }

.skeleton-box {
    background: #e2e8f0;
    border-radius: 12px;
    animation: pulse 1.5s infinite ease-in-out;
}
@keyframes pulse {
    0% { opacity: 0.6; }
    50% { opacity: 0.3; }
    100% { opacity: 0.6; }
}

body.privacy-mode .highlight-blue,
body.privacy-mode .highlight-dark,
body.privacy-mode .highlight-green,
body.privacy-mode .fs-val,
body.privacy-mode .drill-price,
body.privacy-mode .tc-spent,
body.privacy-mode .insight-value,
body.privacy-mode canvas {
    filter: blur(5px);
}

/* Beläggning - Siffran ovanför stapeln */
.hm-val {
    font-size: 0.75rem;
    font-weight: 700;
    color: #64748b;
    margin-bottom: 2px; /* Lite luft ner till stapeln */
}

/* Om det är "högtryck" gör vi siffran blå också */
.hm-col:has(.hm-bar.high) .hm-val {
    color: #3b82f6;
}

/* --- DATOR-ANPASSNING (FIXAD HÖJD) --- */
@media (min-width: 992px) {
    
    /* 1. Göm mobil-headern helt */
    #statisticsView .one-ui-header-simple.sticky-header-fix {
        display: none !important;
    }

    /* 2. TVINGA UPP VYN MED NEGATIV MARGINAL */
    /* Om du fortfarande har tomrum, öka minustecknet (t.ex. -40px) */
    #statisticsView {
        padding-top: 0 !important;
        margin-top: -20px !important; 
        min-height: auto !important; /* Förhindra att den tvingar fram höjd */
    }

    /* 3. Justera Filter-raden så den agerar ny topp */
    .stats-controls-bar {
        padding: 24px 32px 10px 32px !important;
        max-width: 1200px;
        margin: 0 auto;
        
        /* Säkerställ att den ligger överst */
        position: relative;
        z-index: 10;
    }
    
    /* 4. Centrera innehållet */
    .stats-content-wrapper {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 16px;
    }
}

